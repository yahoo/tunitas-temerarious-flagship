#!/bin/sh
source ${0%/*}/framework.sh || exit 1

x99=x99_$b

rm -rf tests/remonstrate/$x99
mkdir -p tests/remonstrate/$x99
cp tests/remonstrate/$b.xcpp tests/remonstrate/$x99/.

srcdir=tests
objdir=obj/tests

# testing the --include and --submodule options
# also as -I and -E
remonstrate \
    -I/build/scold/module-boost/modules \
    -I/build/scold/module-c/modules \
    -I/build/scold/module-cppunit/modules \
    -I/build/scold/module-c-string/modules \
    -I/build/scold/module-curl/modules \
    -I/build/scold/module-file-slurp/modules \
    -I/build/scold/module-format/modules \
    -I/build/scold/module-ip/modules \
    -I/build/scold/module-ish/modules \
    -I/build/scold/module-json/modules \
    -I/build/scold/module-mvr/modules \
    -I/build/scold/module-mysqlpp/modules \
    -I/build/scold/module-options/modules \
    -I/build/scold/module-path/modules \
    -I/build/scold/module-posix/modules \
    -I/build/scold/modules/modules \
    -I/build/scold/module-sqlite/modules \
    -I/build/scold/module-std/modules \
    -I/build/scold/module-sys/modules \
    -I/build/scold/module-unit-rigging/modules \
    -I/build/scold/module-uuid/modules \
    -Eexternal/anguish-answer \
    -Eexternal/hypogeal-twilight \
    -Eexternal/module-boost \
    -Eexternal/module-c \
    -Eexternal/module-cppunit \
    -Eexternal/module-c-string \
    -Eexternal/module-file-slurp \
    -Eexternal/module-format \
    -Eexternal/module-ish \
    -Eexternal/module-mvr \
    -Eexternal/module-options \
    -Eexternal/module-path \
    -Eexternal/module-posix \
    -Eexternal/module-std \
    -Eexternal/module-sys \
    -Eexternal/module-unit-rigging \
    -Eexternal/module-uuid \
    --verbose \
    --debug \
    --make-directories \
    --modulesdir=obj/modules \
    --objdir=obj/src/tests \
    --srcdir=tests \
    tests/remonstrate/x99_example04/example04.xcpp

declare -a files=( \
    obj/modules{/fpp,/hpp,/ipp,}/remonstrate.x99_example04.example04 \
    obj/src/tests/remonstrate/x99_example04/example04.{cpp,mk} \
    tests/remonstrate/x99_example04/example04.xcpp \
)
ls -ld ${files[@]}

for file in ${files[@]}; do
    sed -e "s|^|${file##*/}> |" < $file
done
